<div class="step-text">
<h5 id="description">Description</h5>
<p>Your model can spot the dependencies in the data, but it is useless if it can't make predictions on new samples. Let's add the <code class="java">predict()</code> method to our custom class. This method should take a set of new observations and return an array with predictions of a target variable.</p>
<p>It may be a good idea to implement an internal method that will be called by <code class="java">predict()</code> for each sample in the dataset. Remember that predicting is a recursive process,<strong> </strong>too. The internal predicting method takes a node and a sample from a dataset and works as follows:</p>
<ul>
<li>Checks whether the current node is a leaf;</li>
<li>If the node is a leaf, it returns its label as a label of the given sample;</li>
<li>If the node is not a leaf, it checks the splitting feature of this node. Depending on its value in the sample, the recursive function is called for the left child or the right child of the current node.</li>
</ul>
<h5 id="objectives">Objectives</h5>
<p>Implement the <code class="java">predict()</code> and the internal recursive predicting methods. The first one takes a set of new observations as an argument and returns an array of predicted labels. The other one takes the current (one) sample and the current node (the tree root on the first call) and returns a predicted label for the given sample. During prediction, print the following log messages: if the node is not a leaf, print the splitting feature and its value; if the node is a leaf, print the predicted label. See the Example section for the template. In other words: </p>
<ol>
<li>Take the input paths to two files split by a space: the first one is the training dataset, and the second one is the test dataset;</li>
<li>Read the data from the <em>.csv</em> files;</li>
<li>Train your decision tree on the training set. The minimum number of samples for a node to be considered a leaf is <code class="java">1</code> by default. The <code class="java">Survived</code> column is a target variable. Separate it from the dataset with features;</li>
<li>Make predictions on the test set by applying the <code class="java">predict()</code> method.</li>
</ol>
<p>The result of the stage is a set of log messages during prediction. Don't forget to disable the log messages from the previous stages.</p>
<p>If you have corrupted CSV files, please download <a href="https://cogniterra.org/media/attachments/lesson/26605/data_stage5_train.csv" rel="noopener noreferrer nofollow" target="_blank">training dataset</a> and <a href="https://cogniterra.org/media/attachments/lesson/26605/data_stage5_test.csv" rel="noopener noreferrer nofollow" target="_blank">test dataset</a>. Place them in the <em>test</em> directory.</p>
<h5 id="example">Example</h5>
<p>The example below shows the structure of the files and the expected answer.</p>
<p><em>Contents of <code class="java">data_stage5_train.csv</code></em> <em>file:</em></p>
<pre><code class="language-no-highlight">    Pclass 	Sex 	SibSp 	Parch 	Survived
0 	1 	0 	0 	0 	0
1 	3 	0 	1 	1 	1
2 	1 	1 	1 	0 	1
3 	3 	1 	0 	1 	1
4 	3 	0 	0 	0 	0
5 	3 	1 	1 	5 	0
6 	3 	0 	0 	0 	0
7 	2 	0 	0 	0 	1
8 	2 	1 	0 	1 	1
9 	2 	1 	0 	0 	1
10 	2 	0 	1 	2 	0
11 	3 	1 	4 	2 	0
12 	3 	0 	0 	0 	0
13 	1 	1 	1 	0 	1
14 	2 	0 	0 	0 	0
15 	2 	0 	2 	0 	0
16 	3 	1 	0 	0 	1
17 	1 	0 	0 	0 	1
18 	2 	0 	0 	0 	0
19 	3 	1 	5 	2 	0</code></pre>
<p><em>Contents of </em><code class="java">data_stage5_test.csv</code> <em>file:</em></p>
<pre><code class="language-no-highlight"> 	Pclass 	Sex 	SibSp 	Parch
0 	3 	0 	1 	0
1 	1 	1 	1 	0</code></pre>
<p><em>Program output:</em></p>
<pre><code class="language-no-highlight">&gt; test/data_stage5_train.csv test/data_stage5_test.csv
Prediction for sample # 0
   Considering decision rule on feature Parch with value 1
   Considering decision rule on feature Pclass with value 1
   Considering decision rule on feature SibSp with value 0
   Predicted label: 0
Prediction for sample # 1
   Considering decision rule on feature Parch with value 1
   Considering decision rule on feature Pclass with value 1
   Considering decision rule on feature Sex with value 0
   Predicted label: 1</code></pre>
</div>